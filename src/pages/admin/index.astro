---
import AdminLayout from '../../layouts/AdminLayout.astro';
import AdminDashboard from '../../components/admin/AdminDashboard.tsx';
import { getAdminAuth, requireAdmin } from '../../lib/auth';

// Protect this page - only admins can access
const auth = await getAdminAuth(Astro);
const user = requireAdmin(auth);

if (!user) {
  return Astro.redirect('/auth/login?redirect=/admin');
}
---

<AdminLayout title="Panel de Control" user={user} currentPage="/admin">
  <div class="p-6">
    <!-- Welcome Header -->
    <div class="mb-8">
      <h2 class="text-2xl font-bold text-gray-900">
        ¡Bienvenido, {user.full_name || user.email}!
      </h2>
      <p class="text-gray-600 mt-1">Panel de administración MODTOK - Gestiona tu plataforma</p>
    </div>

    <!-- React Dashboard Component -->
    <AdminDashboard client:load user={user} />
  </div>
</AdminLayout>